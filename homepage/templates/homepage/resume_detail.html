{% extends "base.html" %}
{% load i18n %}
{% load url_target_blank %}
{% block content %}
<section id="support">
    <h1>{% trans "Resume" %}</h1>
    <h2>{{ resume.name }}</h2>
    <table class="table table-bordered">
        <tr>
            <th>{% trans 'Status' %}</th>
            <td>{{ resume.get_status_display }}</td>
        </tr>
        <tr>
            <th>{% trans 'Apply to' %}</th>
            <td>{{ resume.apply_to }}</td>
        </tr>
        <tr>
            <th>{% trans 'Email' %}</th>
            <td>{{ resume.email }}</td>
        </tr>
        {% if resume.desc.linkedin %}
        <tr>
            <th>{% trans 'LinkedIn' %}</th>
            <td>{{ resume.desc.linkedin|urlize|url_target_blank }}</td>
        </tr>
        {% endif %}
        {% if resume.desc.homepage %}
        <tr>
            <th>{% trans 'Homepage' %}</th>
            <td>{{ resume.desc.homepage|urlize|url_target_blank }}</td>
        </tr>
        {% endif %}
        {% if resume.desc.github %}
        <tr>
            <th>{% trans 'Github' %}</th>
            <td><a href="https://github.com/{{ resume.desc.github }}">{{ resume.desc.github }}</a></td>
        </tr>
        {% endif %}
        <tr>
            <th>{% trans 'Last update' %}</th>
            <td>{{ resume.modified }}</td>
        </tr>
    </table>
    {% if perms.homepage.change_resume %}
    <h3>
        {% trans "Review" %}
        {% if user.id not in resume.rated_by %}
            <a class="btn btn-blue" href="{% url 'resumereview_add' resume.uuid %}">
                {% trans "Review now" %}
            </a>
        {% endif %}
    </h3>
    {% if resume.resumereview_set.all|length > 0 %}
    <table class="table table-bordered">
        {% for r in resume.resumereview_set.all %}
        <tr>
            <td>{{ r.user.username }}</td>
            <td>{{ r.rating }}</td>
            <td>
                {% if r.user == user %}
                <a class="btn pull-right" href="{% url 'resumereview_update' r.id %}">{% trans "Update" %}</a>
                {% endif %}
                {{ r.desc|safe }}
                <br><small>{{ r.modified }}</small>
            </td>
        </tr>
        {% endfor %}
    </table>
    {% else %}
    <p>
        {% trans "No review, yet" %}
    </p>
    {% endif %}
    {% endif %}
    <table class="table table-striped table-bordered">
        {% if resume.desc.description %}
        <tr>
            <th>{% trans 'Description' %}</th>
        </tr>
        <tr>
            <td>{{ resume.desc.description|safe }}</td>
        </tr>
        {% endif %}
        {% if resume.desc.resume %}
        <tr>
            <th>{% trans 'Resume' %}</th>
        </tr>
        <tr>
            <td>{{ resume.desc.resume|safe }}</td>
        </tr>
        {% endif %}
        {% if resume.attachment %}
        <tr>
            <th>{% trans 'Attachment' %}</th>
        </tr>
        <tr>
            <td><a href="{{ resume.attachment.url }}">{{ resume.attachment.url }}</a></td>
        </tr>
        {% endif %}
    </table>
    <p>
        {% if resume.in_draft %}
        <a class="btn btn-blue" href="{% url 'resume_update' resume.uuid %}">{% trans 'Update' %}</a>
        {% endif %}
        <a class="btn btn-red" href="{% url 'resume_delete' resume.uuid %}">{% trans 'Delete' %}</a>
    </p>
</section>
{% endblock %}
